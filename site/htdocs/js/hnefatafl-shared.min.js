"use strict";var hnefataflNameSpace={squareSize:62,boardInset:28,pieceGraphicalOffset:12,originalWidth:612,highlightSquare:[],board:[],initialisehnefataflGame:function(){hnefataflNameSpace.board=[["0","0","0","b","b","b","0","0","0"],["0","0","0","0","b","0","0","0","0"],["0","0","0","0","w","0","0","0","0"],["b","0","0","0","w","0","0","0","b"],["b","b","w","w","W","w","w","b","b"],["b","0","0","0","w","0","0","0","b"],["0","0","0","0","w","0","0","0","0"],["0","0","0","0","b","0","0","0","0"],["0","0","0","b","b","b","0","0","0"]],hnefataflNameSpace.boardWidth=hnefataflNameSpace.board[0].length,hnefataflNameSpace.boardHeight=hnefataflNameSpace.board.length,hnefataflNameSpace.imagesToLoad=[{name:"board",src:"/images/hnefatafl/board.jpg"},{name:"highlight",src:"/images/hnefatafl/highlight.png"},{name:"active-white",src:"/images/hnefatafl/active-player-white.png"},{name:"active-black",src:"/images/hnefatafl/active-player-black.png"},{name:"white-piece",src:"/images/hnefatafl/white-piece.png"},{name:"black-piece",src:"/images/hnefatafl/black-piece.png"},{name:"king",src:"/images/hnefatafl/king.png"}],document.getElementById("hnefataflGame").addEventListener("click",hnefataflNameSpace.canvasClick,!1),hnefataflNameSpace.gameMode="loading",Loader.preload(hnefataflNameSpace.imagesToLoad,hnefataflNameSpace.initCardGame,loadingProgress)},getCanvasPosition:function(){var a=document.getElementById("hnefataflGame").getBoundingClientRect();hnefataflNameSpace.outerCanvasLeft=a.left,hnefataflNameSpace.outerCanvasTop=a.top,hnefataflNameSpace.outerCanvasWidth=a.right-a.left,hnefataflNameSpace.scale=hnefataflNameSpace.originalWidth/hnefataflNameSpace.outerCanvasWidth,hnefataflNameSpace.outerCanvasHeight=hnefataflNameSpace.outerCanvasWidth,hnefataflNameSpace.pageLoadScroll=document.body.scrollTop+document.documentElement.scrollTop},canvasClick:function(a){a&&a.preventDefault();var e=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,t=a.clientY+document.body.scrollTop+document.documentElement.scrollTop-hnefataflNameSpace.pageLoadScroll;switch(hnefataflNameSpace.gameMode){case"play":case"hnefataflGame":var f=e-hnefataflNameSpace.outerCanvasLeft,n=t-hnefataflNameSpace.outerCanvasTop,l=Math.floor((hnefataflNameSpace.scale*f-hnefataflNameSpace.boardInset)/hnefataflNameSpace.squareSize),h=Math.floor((hnefataflNameSpace.scale*n-hnefataflNameSpace.boardInset)/hnefataflNameSpace.squareSize);if(hnefataflNameSpace.board[h][l].toLowerCase()==hnefataflNameSpace.currentPlayer)hnefataflNameSpace.highlightSquare=[l,h];else{if(hnefataflNameSpace.highlightSquare.length>0){var c=!1,m=hnefataflNameSpace.highlightSquare[0],i=hnefataflNameSpace.highlightSquare[1];if(console.log("moving from "+m+","+i+" to "+l+","+h),h==hnefataflNameSpace.highlightSquare[1])if(c=!0,l>m)for(var r=m+1;r<=l;r++)console.log("checking "+r+","+h+" : "+hnefataflNameSpace.board[h][r]),"0"!=hnefataflNameSpace.board[h][r]&&(c=!1);else for(r=l;r<m;r++)console.log("checking "+r+","+h+" : "+hnefataflNameSpace.board[h][r]),"0"!=hnefataflNameSpace.board[h][r]&&(c=!1);else if(l==hnefataflNameSpace.highlightSquare[0])if(c=!0,h>i)for(r=i+1;r<=h;r++)console.log("checking "+l+","+r+" : "+hnefataflNameSpace.board[r][l]),"0"!=hnefataflNameSpace.board[r][l]&&(c=!1);else for(r=h;r<i;r++)console.log("checking "+l+","+r+" : "+hnefataflNameSpace.board[r][l]),"0"!=hnefataflNameSpace.board[r][l]&&(c=!1);c&&(hnefataflNameSpace.board[h][l]=hnefataflNameSpace.board[hnefataflNameSpace.highlightSquare[1]][hnefataflNameSpace.highlightSquare[0]],hnefataflNameSpace.board[hnefataflNameSpace.highlightSquare[1]][hnefataflNameSpace.highlightSquare[0]]="0","w"==hnefataflNameSpace.currentPlayer?hnefataflNameSpace.currentPlayer="b":hnefataflNameSpace.currentPlayer="w")}hnefataflNameSpace.highlightSquare=[]}}},initCardGame:function(){hnefataflNameSpace.getCanvasPosition(),hnefataflNameSpace.gameCanvas=document.getElementById("hnefataflGame"),hnefataflNameSpace.gameCanvas.getContext&&(hnefataflNameSpace.gameContext=hnefataflNameSpace.gameCanvas.getContext("2d"),hnefataflNameSpace.canvasWidth=hnefataflNameSpace.gameCanvas.width,hnefataflNameSpace.canvasHeight=hnefataflNameSpace.gameCanvas.height),hnefataflNameSpace.boardImage=Loader.getImage("board"),hnefataflNameSpace.highlightImage=Loader.getImage("highlight"),hnefataflNameSpace.activeWhiteImage=Loader.getImage("active-white"),hnefataflNameSpace.activeBlackImage=Loader.getImage("active-black"),hnefataflNameSpace.whitePieceImage=Loader.getImage("white-piece"),hnefataflNameSpace.kingImage=Loader.getImage("king"),hnefataflNameSpace.blackPieceImage=Loader.getImage("black-piece"),hnefataflNameSpace.currentPlayer="w",hnefataflNameSpace.player1="w",hnefataflNameSpace.player2="d",hnefataflNameSpace.isPlayer1AI=!0,hnefataflNameSpace.aiIsWorking=-1,hnefataflNameSpace.waitForDrawUpdate=!1,hnefataflNameSpace.whoCanClick=hnefataflNameSpace.currentPlayersTurn,hnefataflNameSpace.gameMode="play","undefined"!=typeof gameMode&&(gameMode="hnefataflGame")},draw:function(){var a;hnefataflNameSpace.gameContext.drawImage(hnefataflNameSpace.boardImage,0,0),"w"==hnefataflNameSpace.currentPlayer?hnefataflNameSpace.gameContext.drawImage(hnefataflNameSpace.activeWhiteImage,0,0):hnefataflNameSpace.gameContext.drawImage(hnefataflNameSpace.activeBlackImage,0,0),hnefataflNameSpace.highlightSquare.length>0&&hnefataflNameSpace.gameContext.drawImage(hnefataflNameSpace.highlightImage,hnefataflNameSpace.highlightSquare[0]*hnefataflNameSpace.squareSize+hnefataflNameSpace.boardInset,hnefataflNameSpace.highlightSquare[1]*hnefataflNameSpace.squareSize+hnefataflNameSpace.boardInset);for(var e=0;e<hnefataflNameSpace.board.length;e++)for(var t=0;t<hnefataflNameSpace.board[0].length;t++){switch(hnefataflNameSpace.board[e][t]){case"b":a=hnefataflNameSpace.blackPieceImage;break;case"w":a=hnefataflNameSpace.whitePieceImage;break;case"W":a=hnefataflNameSpace.kingImage;break;default:a=""}""!=a&&hnefataflNameSpace.gameContext.drawImage(a,t*hnefataflNameSpace.squareSize+hnefataflNameSpace.boardInset-hnefataflNameSpace.pieceGraphicalOffset,e*hnefataflNameSpace.squareSize+hnefataflNameSpace.boardInset-hnefataflNameSpace.pieceGraphicalOffset)}},update:function(){}};