"use strict";!function(){var e="v::144::",n=e+"static",t="pages",c=e+"images",i=e+"assets",r="/images/offline-fallback.jpg",a=function(){return caches.open(n).then(function(e){return e.addAll(["/chronicle/"]),e.addAll(["/","/images/autumn-earth.svg","/css/base.css","/js/core.min.js","/offline/",r])})},s=function(e,n,t){caches.open(e).then(function(e){e.put(n,t)})},o=function(e,n){caches.open(e).then(function(t){t.keys().then(function(c){c.length>n&&t["delete"](c[0]).then(o(e,n))})})},f=function(){return caches.keys().then(function(n){return Promise.all(n.filter(function(n){return 0!==n.indexOf(e)}).map(function(e){return caches["delete"](e)}))})};self.addEventListener("install",function(e){e.waitUntil(a().then(function(){return self.skipWaiting()}))}),self.addEventListener("activate",function(e){e.waitUntil(f().then(function(){return self.clients.claim()}))}),self.addEventListener("message",function(e){"trimCaches"==e.data.command&&(o(t,20),o(c,30),o(i,10))}),self.addEventListener("fetch",function(e){var n=e.request,a=new URL(n.url);return a.origin===location.origin?"GET"!==n.method?void e.respondWith(fetch(n)["catch"](function(){return caches.match("/offline/")})):-1!==n.headers.get("Accept").indexOf("text/html")?(n=new Request(a,{method:"GET",headers:n.headers,mode:n.mode,credentials:n.credentials,redirect:n.redirect}),void e.respondWith(fetch(n).then(function(e){var c=e.clone();return s(t,n,c),e})["catch"](function(){return caches.match(n).then(function(e){return e||caches.match("/offline/")})}))):void e.respondWith(caches.match(n).then(function(e){return e||fetch(n).then(function(e){if(-1!==n.headers.get("Accept").indexOf("image")){var t=e.clone();s(c,n,t)}if(-1!==n.url.indexOf("/fonts/")||-1!==n.url.indexOf("/js/")||-1!==n.url.indexOf("/css/")){var t=e.clone();s(i,n,t)}return e})["catch"](function(){return-1!==n.headers.get("Accept").indexOf("image")?caches.match(r):void 0})})):void 0})}();