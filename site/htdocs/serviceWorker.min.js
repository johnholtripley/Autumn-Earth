"use strict";!function(){var e="v::171::",n=e.split("::")[1],t=e+"static",c=e+"pages",i=e+"images",r=e+"assets",a="/images/offline-fallback.jpg",s=function(){return caches.open(t).then(function(e){return e.addAll(["/chronicle/"]),e.addAll(["/","/images/autumn-earth.svg","/css/base."+n+".css","/js/core.min."+n+".js","/offline/",a])})},f=function(e,n,t){caches.open(e).then(function(e){e.put(n,t)})},u=function(e,n){caches.open(e).then(function(t){t.keys().then(function(c){c.length>n&&t["delete"](c[0]).then(u(e,n))})})},o=function(){return caches.keys().then(function(n){return Promise.all(n.filter(function(n){return 0!==n.indexOf(e)}).map(function(e){return caches["delete"](e)}))})};self.addEventListener("install",function(e){e.waitUntil(s().then(function(){return self.skipWaiting()}))}),self.addEventListener("activate",function(e){e.waitUntil(o().then(function(){return self.clients.claim()}))}),self.addEventListener("message",function(e){"trimCaches"==e.data.command&&(u(c,20),u(i,30),u(r,10))}),self.addEventListener("fetch",function(e){var n=e.request,t=new URL(n.url);if(t.origin===location.origin&&"GET"===n.method)return n.headers.get("Accept").indexOf("text/html")!==-1?void e.respondWith(fetch(n).then(function(e){var t=e.clone();return f(c,n,t),e})["catch"](function(){return caches.match(n).then(function(e){return e||caches.match("/offline/")})})):void e.respondWith(caches.match(n).then(function(e){return e||fetch(n).then(function(e){if(n.headers.get("Accept").indexOf("image")!==-1){var t=e.clone();f(i,n,t)}if(n.url.indexOf("/fonts/")!==-1||n.url.indexOf("/js/")!==-1||n.url.indexOf("/css/")!==-1){var t=e.clone();f(r,n,t)}return e})["catch"](function(){if(n.headers.get("Accept").indexOf("image")!==-1)return caches.match(a)})}))})}();